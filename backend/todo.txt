 –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã Backend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

  üéØ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å –¥–ª—è MVP

  –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. Backend –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ - –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –∏ pom.xml. –û–ø—Ä–µ–¥–µ–ª—è—é –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:

  ---
  Phase 1: Foundation (—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç)

  –¶–µ–ª—å: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

  1. common - –æ–±—â–∏–µ –∫–ª–∞—Å—Å—ã
    - BaseException (–±–∞–∑–æ–≤—ã–π exception —Å HTTP —Å—Ç–∞—Ç—É—Å–∞–º–∏)
    - ApiResponse<T> (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π response wrapper)
    - Constants, enums
  2. config - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - SecurityConfig (JWT + CORS)
    - JacksonConfig (–¥–ª—è JSONB)
    - RedisConfig (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
  3. security - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    - JWT filter, provider
    - UserDetailsService
  4. user - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    - Entity, Repository, Service, Controller
    - Registration, Login, Profile

  ---
  Phase 2: Core Domain (–æ—Å–Ω–æ–≤–∞ –∫—É—Ä—Å–æ–≤)

  –¶–µ–ª—å: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

  5. course - –∫—É—Ä—Å—ã
    - Course entity (—Ö—Ä–∞–Ω–∏—Ç scenario JSON)
    - Service –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ scenario_1.0.1.json
    - Repository, Controller

  ---
  Phase 3: State Management (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) ‚ö†Ô∏è –í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

  –¶–µ–ª—å: –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ userData

  6. progress - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
    - UserProgress entity:
    - userId, courseId
  - currentSessionId, currentBlockIndex
  - userData (JSONB) - –∫–ª—é—á–µ–≤–æ–µ –ø–æ–ª–µ!
  - completedSessions[]
    - ProgressService (CRUD –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è)
    - Repository

  ---
  Phase 4: LLM Integration ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ö–û–ú–ü–û–ù–ï–ù–¢

  –¶–µ–ª—å: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Claude API

  7. llm - Claude API
    - ClaudeService:
        - generateResponse(prompt, userData) - –¥–ª—è LLM_RESPONSE –±–ª–æ–∫–æ–≤
      - chat(messages[], userData) - –¥–ª—è LLM_CONVERSATION
      - Stream support –¥–ª—è real-time –æ—Ç–≤–µ—Ç–æ–≤
    - Template resolver –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
    - Error handling + retry logic

  ---
  Phase 5: Course Engine ‚ö†Ô∏è –Ø–î–†–û –°–ò–°–¢–ï–ú–´

  –¶–µ–ª—å: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è JSON —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

  8. engine - CourseEngine
  CourseEngine
  ‚îú‚îÄ‚îÄ processBlock(blockId, userInput)
  ‚îú‚îÄ‚îÄ resolveTemplate(template, userData)
  ‚îî‚îÄ‚îÄ determineNext(block, userData)

  BlockHandlerRegistry
  ‚îî‚îÄ‚îÄ Map<BlockType, BlockHandler>

  BlockHandlers (12 —Ç–∏–ø–æ–≤):
  ‚îú‚îÄ‚îÄ StaticBlockHandler
  ‚îú‚îÄ‚îÄ InputBlockHandler
  ‚îú‚îÄ‚îÄ SliderBlockHandler
  ‚îú‚îÄ‚îÄ SingleSelectBlockHandler
  ‚îú‚îÄ‚îÄ MultiSelectBlockHandler
  ‚îú‚îÄ‚îÄ LlmConversationBlockHandler ‚ûú –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ClaudeService
  ‚îú‚îÄ‚îÄ LlmResponseBlockHandler ‚ûú –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ClaudeService
  ‚îú‚îÄ‚îÄ ExerciseBlockHandler
  ‚îú‚îÄ‚îÄ VisualizationBlockHandler
  ‚îú‚îÄ‚îÄ CalculationBlockHandler
  ‚îú‚îÄ‚îÄ SessionCompleteBlockHandler
  ‚îî‚îÄ‚îÄ PaywallBlockHandler

  ---
  Phase 6: Session API

  –¶–µ–ª—å: REST API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

  9. session - API endpoints
    - POST /api/sessions/start - –Ω–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é
    - GET /api/sessions/current - —Ç–µ–∫—É—â–∏–π –±–ª–æ–∫
    - POST /api/sessions/submit - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –±–ª–æ–∫
    - GET /api/sessions/{id}/blocks/{blockId} - –ø–æ–ª—É—á–∏—Ç—å –±–ª–æ–∫
    - SessionController + SessionService

  ---
  Phase 7: Post-MVP (–ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤—ã)

  10. checkin - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —á–µ–∫-–∏–Ω—ã (GAD-7, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)
  11. subscription - RevenueCat –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
  12. gamification - —Å—Ç—Ä–∏–∫–∏, –∞—á–∏–≤–∫–∏
  13. notification - push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

  ---
  üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

  Week 1: Foundation
    Day 1-2: common + config + security
    Day 3-4: user (auth, registration)
    Day 5: course (load scenario from JSON)

  Week 2: Core Engine
    Day 1-2: progress (UserProgress entity + service)
    Day 3-4: llm (ClaudeService + template resolver)
    Day 5: engine skeleton (CourseEngine + Registry)

  Week 3: Handlers + API
    Day 1-2: Basic handlers (Static, Input, Select)
    Day 3: LLM handlers (using ClaudeService)
    Day 4-5: session API + integration tests

  Week 4: Testing & Polish
    Day 1-3: End-to-end —Ç–µ—Å—Ç—ã
    Day 4-5: Bug fixes, edge cases